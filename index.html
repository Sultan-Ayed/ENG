<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shadow English â€” Ù…. Ø³Ù„Ø·Ø§Ù† Ø¨Ù† Ø¹Ø§ÙŠØ¯</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0e1a; --card: #1a2235; --accent: #00d4aa;
    --gold: #ffd93d; --text: #e8eaf0; --muted: #6b7a99; --border: #2a3550;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--bg); color:var(--text); font-family:'Tajawal',sans-serif; min-height:100vh; }
  
  /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· ØªØ±Ø¬Ù…Ø© Ø¬ÙˆØ¬Ù„ */
  #google_translate_element { display: none !important; }
  .goog-te-banner-frame.skiptranslate { display: none !important; }
  body { top: 0px !important; }

  .wrap { max-width:960px; margin:0 auto; padding:2rem 1.5rem; position:relative; z-index:1; }

  /* Header Section */
  .header { text-align:center; margin-bottom:2.5rem; }
  .badge { display:inline-block; background:rgba(0,212,170,.12); border:1px solid rgba(0,212,170,.35); color:var(--accent); font-size:.72rem; letter-spacing:3px; text-transform:uppercase; padding:.35rem 1.1rem; border-radius:100px; margin-bottom:.9rem; font-family:'Space Mono',monospace; }
  .header h1 { font-size:clamp(2rem,5vw,3rem); font-weight:900; line-height:1.1; color:#fff; margin-bottom: 1.2rem; }
  .header h1 span { color:var(--accent); }
  
  /* Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø³Ù„Ø·Ø§Ù† */
  .dedication-card {
    display: inline-flex; align-items: center; gap: 1rem;
    background: linear-gradient(90deg, rgba(0, 212, 170, 0.1), rgba(26, 34, 53, 0.5));
    border: 1px solid rgba(0, 212, 170, 0.3);
    padding: 0.7rem 1.8rem; border-radius: 50px; margin-top: 5px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }
  .ded-label { color: var(--muted); font-size: 0.85rem; }
  .ded-name { color: #fff; font-weight: 700; font-size: 1.1rem; }
  .ded-btn { 
    background: var(--accent); color: #0a0e1a; 
    text-decoration: none; padding: 0.3rem 1rem; 
    border-radius: 20px; font-size: 0.75rem; font-weight: 900;
    transition: 0.3s;
  }
  .ded-btn:hover { background: #fff; transform: scale(1.05); }

  /* UI Components */
  .card { background:var(--card); border:1px solid var(--border); border-radius:20px; margin-bottom:1.5rem; overflow:hidden; }
  .card-head { padding:.9rem 1.4rem; border-bottom:1px solid var(--border); background:rgba(0,0,0,.18); display:flex; align-items:center; justify-content:space-between; }
  .card-title { font-size:.8rem; color:var(--muted); letter-spacing:2px; text-transform:uppercase; font-family:'Space Mono',monospace; }
  .video-wrap { position:relative; width:100%; padding-top:56.25%; background:#000; }
  .video-wrap iframe { position:absolute; inset:0; width:100%; height:100%; border:none; }

  /* Transcript Lines */
  .tr-body { padding:.9rem; max-height:500px; overflow-y:auto; }
  .t-line { display:flex; gap:1rem; padding:1.2rem; border-radius:12px; cursor:pointer; margin-bottom:.6rem; border:1px solid transparent; transition: 0.3s; background: rgba(255,255,255,0.02); }
  .t-line:hover { background:rgba(255,255,255,0.04); }
  .t-line.active { background:rgba(0,212,170,0.12); border-color:var(--accent); }

  .content-box { flex: 1; display: flex; flex-direction: column; gap: 8px; }
  .t-en { font-size:1.1rem; color: #fff; font-family:'Space Mono',monospace; direction:ltr; text-align:left; font-weight: 600; }
  .t-ar { font-size:.95rem; color:var(--accent); direction:rtl; text-align:right; display:none; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.05); }
  
  .show-ar .t-ar { display:block; animation: slideDown 0.3s ease; }
  @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

  .t-time { font-size:.75rem; color:var(--accent); font-family:'Space Mono',monospace; min-width:45px; margin-top: 4px; }
  .btn { background:var(--accent); color:#000; border:none; border-radius:12px; padding:1rem; font-weight:900; cursor:pointer; width: 100%; font-size: 1rem; }
  .btn-sm { background:var(--accent); color:#000; border:none; border-radius:8px; padding:.4rem 1rem; font-size:.8rem; font-weight:700; cursor:pointer; }
  
  .hidden { display: none; }
  .url-input, .tr-input { background:var(--bg); border:2px solid var(--border); border-radius:12px; padding:1rem; color:#fff; width:100%; margin-bottom: 12px; outline: none; }
  .url-input:focus, .tr-input:focus { border-color: var(--accent); }
</style>
</head>
<body>

<div id="google_translate_element"></div>

<div class="wrap">
  <div class="header">
    <div class="badge">LEARN BY SHADOWING ğŸ§</div>
    <h1>ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©<br><span>Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù…ØªÙ†Ø§Ù‡ÙŠØ©</span></h1>
    
    <div class="dedication-card">
      <span class="ded-label">Ø¥Ù‡Ø¯Ø§Ø¡ Ù…Ù†</span>
      <span class="ded-name">Ù…. Ø³Ù„Ø·Ø§Ù† Ø¨Ù† Ø¹Ø§ÙŠØ¯</span>
      <a href="https://sultan-ayed.github.io/my/" target="_blank" class="ded-btn">Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹ÙŠ ğŸŒ</a>
    </div>
  </div>

  <div id="setupSection">
    <div class="card">
      <div class="card-body" style="padding:1.5rem;">
        <input type="text" id="videoUrl" class="url-input" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨ Ù‡Ù†Ø§...">
        <textarea id="trInput" class="tr-input" rows="8" placeholder="Ø¶Ø¹ Ø§Ù„Ù†Øµ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ (Transcript) Ù‡Ù†Ø§..."></textarea>
        <button class="btn" onclick="startSession()">Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„Ù… â–¶</button>
      </div>
    </div>
  </div>

  <div id="playerSection" class="hidden">
    <div class="card">
      <div class="video-wrap"><div id="ytContainer"></div></div>
    </div>

    <div class="card">
      <div class="card-head">
        <span class="card-title">ğŸ“„ Ø§Ù„Ù†Øµ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø©</span>
        <button class="btn-sm" id="trBtn" onclick="toggleTranslation()">ğŸŒ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
      </div>
      <div class="tr-body" id="trBody"></div>
    </div>
  </div>
</div>

<script>
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'ar'}, 'google_translate_element');
}
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script>
let player, lines = [];

function getYTId(url) {
  const m = url.match(/(?:youtube\.com\/(?:watch\?(?:.*&)?v=|shorts\/|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
  return m ? m[1] : null;
}

function parseTranscript(raw) {
  const rows = raw.split('\n').filter(r => r.trim());
  const result = [];
  const timeRE = /^(\d{1,2}):(\d{2})(?::(\d{2}))?$/;

  for (let i = 0; i < rows.length; i++) {
    let line = rows[i].trim();
    let timeMatch = line.match(timeRE);
    if (timeMatch) {
      let secs = timeMatch[3] !== undefined ? +timeMatch[1]*3600 + +timeMatch[2]*60 + +timeMatch[3] : +timeMatch[1]*60 + +timeMatch[2];
      let text = rows[++i] ? rows[i].trim() : "";
      result.push({time: secs, en: text});
    }
  }
  return result;
}

function startSession() {
  const url = document.getElementById('videoUrl').value;
  const raw = document.getElementById('trInput').value;
  const id = getYTId(url);
  if (!id || !raw) return alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ù„Ù†Øµ");
  
  lines = parseTranscript(raw);
  document.getElementById('setupSection').classList.add('hidden');
  document.getElementById('playerSection').classList.remove('hidden');
  renderLines();
  
  const tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  document.head.appendChild(tag);
  
  window.onYouTubeIframeAPIReady = () => {
    player = new YT.Player('ytContainer', {
      videoId: id,
      events: { onReady: () => {
        setInterval(() => {
          const t = player.getCurrentTime();
          let currentLine = 0;
          lines.forEach((l, i) => { if (t >= l.time) currentLine = i; });
          document.querySelectorAll('.t-line').forEach((el, i) => {
            el.classList.toggle('active', i === currentLine);
          });
        }, 500);
      }}
    });
  };
}

function toggleTranslation() {
  const trBody = document.getElementById('trBody');
  const btn = document.getElementById('trBtn');
  
  if (trBody.classList.contains('show-ar')) {
    trBody.classList.remove('show-ar');
    btn.textContent = "ğŸŒ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©";
  } else {
    const combo = document.querySelector('.goog-te-combo');
    if (combo) { combo.value = 'ar'; combo.dispatchEvent(new Event('change')); }
    
    lines.forEach((l, i) => {
      const arEl = document.getElementById(`ar-${i}`);
      if (arEl) arEl.textContent = l.en; 
    });
    
    trBody.classList.add('show-ar');
    btn.textContent = "ğŸ“„ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©";
  }
}

function renderLines() {
  const body = document.getElementById('trBody');
  body.innerHTML = lines.map((l, i) => `
    <div class="t-line" onclick="player.seekTo(${l.time})">
      <span class="t-time">${Math.floor(l.time/60)}:${(l.time%60).toString().padStart(2,'0')}</span>
      <div class="content-box">
        <div class="t-en">${l.en}</div>
        <div class="t-ar" id="ar-${i}"></div>
      </div>
    </div>
  `).join('');
}
</script>
</body>
</html>
